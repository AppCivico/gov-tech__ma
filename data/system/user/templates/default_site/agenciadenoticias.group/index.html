{layout="default_site:site/_layout" root_class="news-agency"}

{if segment_2 == "" OR segment_2 ~ "/^P\d+/" OR segment_2 == config:reserved_category_word}
    <main class="h-feed">
        <header class="h-feed__header">
            {if segment_2 == config:reserved_category_word}
                {exp:channel:category_heading disable="category_fields"}
                    <h1>{category_name}</h1>

                    {layout:set name="title"}{category_name}{/layout:set}

                    {if category_description}
                        <p>{category_description}</p>
                    {/if}
                {/exp:channel:category_heading}
            {if:else}
                <h1 class="h-feed__p-name">Últimas notícias</h1>

                {layout:set name="title"}Últimas notícias{/layout:set}
            {/if}
        </header>

        {exp:channel:entries channel="news" limit="10" disable="category_fields|member_data" status="not closed" paginate="inline" parse="inward"}
            {if count == "1"}
                <section class="h-feed__list h-feed__list--news">
            {/if}
                    <article id="entry-{entry_id}" class="h-feed__h-entry h-entry">
                        <a
                            {if channel_short_name == "page" || page_uri}
                                href="{page_uri}"
                            {if:else}
                                href="https:/{relative_url}/{url_title}"
                            {/if}
                            class="h-entry__u-url"
                        >
                            <header class="h-entry__header">
                                <h3 class="h-entry__p-name p-name">{title}</h3>

                                <time class="dt-published" datetime="{entry_date format="{DATE_ISO8601}"}">
                                    {entry_date format="%d/%m/%Y"}

                                    <span class="dt-published__time">
                                        {entry_date format="%H:%i"}
                                    </span>
                                </time>

                                {if global:editorial-group}
                                    {categories limit="1" show_group="{global:editorial-group}"}
                                        <ul class="h-entry__p-category-list">
                                    {/categories}

                                        {categories show_group="{global:editorial-group}"}
                                            <li class="h-entry__p-category-item" {if color}style="background-color: {color};"{/if}>
                                                {category_name}
                                            </li>
                                        {/categories}

                                    {categories limit="1" show_group="{global:editorial-group}"}
                                        </ul>
                                    {/categories}
                                {/if}
                            </header>

                            {thumbnail}
                                <img
                                        width="260" height="200"
                                        src="{url:thumb--aside}"
                                        decoding="async" loading="lazy"
                                        class="h-entry__u-photo h-entry__u-photo--last-news u-photo"
                                        alt="{description}"
                                />
                            {/thumbnail}

                            <div class="h-entry__p-summary">
                                {if summary}
                                    <p>{summary:limit characters="280" end_char="…"}</p>
                                {if:else}
                                    {body:limit characters="280" end_char="…"}
                                {/if}
                            </div>
                        </a>

                        <footer>
                            <ul class="social-networks social-networks--news-agency">
                                <li class="social-networks__item">
                                    <a href='https://t.me/share/url?url={if page_uri}{page_uri}{if:else}https:/{relative_url}/{url_title}{/if}&text={if summary}{summary}{if:else}{body:limit characters="280" end_char="…"}{/if}' target="_blank" class="u-url social-networks__link">
                                        Compartilhar via Telegram
                                    </a>
                                </li>

                                <li class="social-networks__item">
                                    <a href='https://api.whatsapp.com/send?phone={phone_number}&text={title}%20{if page_uri}{page_uri}{if:else}https:/{relative_url}/{url_title}{/if}' target="_blank" class="u-url social-networks__link">
                                        Compartilhar via WhatsApp
                                    </a>
                                </li>

                                <li class="social-networks__item">
                                    <a href='https://www.facebook.com/sharer.php?u={if page_uri}{page_uri}{if:else}https:/{relative_url}/{url_title}{/if}' target="_blank" class="u-url social-networks__link">
                                        Compartilhar via Facebook
                                    </a>
                                </li>

                                <li class="social-networks__item">
                                    <a href='https://twitter.com/intent/tweet?url={if page_uri}{page_uri}{if:else}https:/{relative_url}/{url_title}{/if}&text={title}' target="_blank" class="u-url social-networks__link">
                                        Compartilhar via Twitter
                                    </a>
                                </li>

                                <li class="social-networks__item">
                                    <a href='mailto:{email_address}?subject={title}&body={if page_uri}{page_uri}{if:else}https:/{relative_url}/{url_title}{/if} {if summary}{summary}{if:else}{body:limit characters="280" end_char="…"}{/if}' target="_blank" class="u-url social-networks__link">
                                        Compartilhar via email
                                    </a>
                                </li>
                            </ul>
                        </footer>
                    </article>
            {if count == total_results}
                </section>
                {tp-pagination}
            {/if}
        {/exp:channel:entries}
    </main>
{if:elseif segment_2 AND segment_2 != config:reserved_category_word AND segment_3 == ""}
    {tp-generic_entry}
{if:else}
    {redirect="404"}
{/if}
